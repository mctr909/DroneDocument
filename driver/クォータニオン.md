# クォータニオンの定義
>
> ## 記法と名称
>> $`\begin{align}\tilde{q}=q_w+q_xi+q_yj+q_zk\end{align}`$  
>>
>> - 文字の上部に~(チルダ)を付けることでクォータニオンを表す
>> - $`q_w,\ q_x,\ q_y,\ q_z`$は実数とする
>> - $`i,\ j,\ k`$は**虚数単位**という
>> - $`q_w,\ q_xi,\ q_yj,\ q_zk`$の4つをまとめて$`\tilde{q}`$の**成分**という
>> - $`q_w`$を$`\tilde{q}`$の**実部**という
>> - $`q_xi,\ q_yj,\ q_zk`$を$`\tilde{q}`$の**虚部**という
>>
> ## 虚数単位の基本法則
>> $`\begin{align}i^2=j^2=k^2=-1\\i\neq j\neq k\neq\sqrt{-1}\end{align}`$  
>>
>> **虚数単位同士の関係**  
>> $`\begin{align}\begin{matrix}i=jk\\j=ki\\k=ij\end{matrix}\end{align}`$  
>>
>> **反交換性**  
>> $`\begin{align}\begin{matrix}kj=-jk=-i\\ik=-ki=-j\\ji=-ij=-k\end{matrix}\end{align}`$  
>>
>> **イメージを用いた虚数単位同士の関係と反交換性の覚え方**  
>>
>> - 虚数単位を2乗したら-1とする
>> - 虚数単位は$`\sqrt{-1}`$とすることはできない
>> - 虚数単位同士の関係は2つ1組の積で表し、$`i=jk,\ j=ki,\ k=ij`$とする
>> - 虚数単位同士の関係について積の順序を変えたら符号を反転させる、このことを反交換性という
>> - 反交換性により虚数単位の交換法則は成り立たない
>>
> ## 虚数単位の結合法則
>> 虚数単位を2つ1組の積でまとめ、[虚数単位の基本法則](#虚数単位の基本法則)を適用して確認する  
>> $`\begin{align}\begin{matrix}
\begin{matrix}ijk\\(ij)k=i(jk)\\(k)k=i(i)\\-1=-1\end{matrix}
&\quad\begin{matrix}jki\\(jk)i=j(ki)\\(i)i=j(j)\\-1=-1\end{matrix}
&\quad\begin{matrix}kij\\(ki)j=k(ij)\\(j)j=k(k)\\-1=-1\end{matrix}
\\\\
\begin{matrix}ikj\\(ik)j=i(kj)\\(-ki)j=i(-jk)\\(-j)j=i(-i)\\1=1\end{matrix}
&\quad\begin{matrix}jik\\(ji)k=j(ik)\\(-ij)k=j(-ki)\\(-k)k=j(-j)\\1=1\end{matrix}
&\quad\begin{matrix}kji\\(kj)i=k(ji)\\(-jk)i=k(-ij)\\(-i)i=k(-k)\\1=1\end{matrix}
\end{matrix}\end{align}`$  
>>
>> - 虚数単位の結合法則は成り立つ
>>
> ## クォータニオン積
>> $`\tilde{q}\tilde{p}`$の成分を書き出して確認する  
>> $`\begin{align}\tilde{q}\tilde{p}=(q_w+q_xi+q_yj+q_zk)(p_w+p_xi+p_yj+p_zk)\end{align}`$  
>> 虚数単位の積の順序を変えないように意識して展開する  
>> $`\begin{align}\begin{matrix}
=q_wp_w &+q_wp_xi &+q_wp_yj &+q_wp_zk\\
+q_xp_wi&+q_xp_xii&+q_xp_yij&+q_xp_zik\\
+q_yp_wj&+q_yp_xji&+q_yp_yjj&+q_yp_zjk\\
+q_zp_wk&+q_zp_xki&+q_zp_ykj&+q_zp_zkk
\end{matrix}\end{align}`$  
>> [虚数単位の基本法則](#虚数単位の基本法則)を適用する  
>> $`\begin{align}\begin{matrix}
=q_wp_w &+q_wp_xi&+q_wp_yj&+q_wp_zk\\
+q_xp_wi&-q_xp_x &+q_xp_yk&-q_xp_zj\\
+q_yp_wj&-q_yp_xk&-q_yp_y &+q_yp_zi\\
+q_zp_wk&+q_zp_xj&-q_zp_yi&-q_zp_z
\end{matrix}\end{align}`$  
>> 同類項をまとめる  
>> $`\begin{align}\begin{matrix}
=(q_wp_w&-q_xp_x&-q_yp_y&-q_zp_z)\\
+(q_xp_w&+q_wp_x&-q_zp_y&+q_yp_z)i\\
+(q_yp_w&+q_zp_x&+q_wp_y&-q_xp_z)j\\
+(q_zp_w&-q_yp_x&+q_xp_y&+q_wp_z)k
\end{matrix}\end{align}`$  
>>
>> - これを$`\tilde{q}`$と$`\tilde{p}`$のクォータニオン積という
>>
> ## クォータニオン積の非可換性
>> $`\tilde{q}\tilde{p}`$の成分と$`\tilde{p}\tilde{q}`$の成分を比較し、添え字付き部分の符号が異なることを確認  
>> $`\begin{align}\begin{matrix}
\begin{matrix}\tilde{q}\tilde{p}&=(q_wp_w&-q_xp_x&-q_yp_y&-q_zp_z)\\
&+(q_xp_w&+q_wp_x&{-q_zp_y}_{\,1}&{+q_yp_z}_{\,2})i\\
&+(q_yp_w&{+q_zp_x}_{\,3}&+q_wp_y&{-q_xp_z}_{\,4})j\\
&+(q_zp_w&{-q_yp_x}_{\,5}&{+q_xp_y}_{\,6}&+q_wp_z)k
\end{matrix}\\\\
\begin{matrix}\tilde{p}\tilde{q}&=(p_wq_w&-p_xq_x&-p_yq_y&-p_zq_z)\\
&+(p_xq_w&+p_wq_x&{-p_zq_y}_{\,2}&{+p_yq_z}_{\,1})i\\
&+(p_yq_w&{+p_zq_x}_{\,4}&+p_wq_y&{-p_xq_z}_{\,3})j\\
&+(p_zq_w&{-p_yq_x}_{\,6}&{+p_xq_y}_{\,5}&+p_wq_z)k
\end{matrix}\\\\
\therefore \tilde{q}\tilde{p}\neq\tilde{p}\tilde{q}
\end{matrix}\end{align}`$  
>>
>> - クォータニオン積の順序を変えると一致しない、このことを<ruby>非<rt>ひ</rt></ruby><ruby>可換<rt>かかん</rt></ruby>であるという
>> - 実部は順序による影響を受けない
>> - 虚部は虚部同士の積の符号が反転する
>>
> ## 共役クォータニオン
>> $`\begin{align}\tilde{q}^\ast=q_w-q_xi-q_yj-q_zk\end{align}`$  
>>
>> $`(\tilde{q}\tilde{p})^\ast`$の成分と$`\tilde{p}^\ast\tilde{q}^\ast`$の成分を比較し、等しくなることを確認  
>> $`\begin{align}\begin{matrix}
&(\tilde{q}\tilde{p})^\ast=\left[(q_w+q_xi+q_yj+q_zk)(p_w+p_xi+p_yj+p_zk)\right]^\ast\\
&=\left[\begin{matrix}
 (q_wp_w&-q_xp_x&-q_yp_y&-q_zp_z)\\
+(q_xp_w&+q_wp_x&-q_zp_y&+q_yp_z)i\\
+(q_yp_w&+q_zp_x&+q_wp_y&-q_xp_z)j\\
+(q_zp_w&-q_yp_x&+q_xp_y&+q_wp_z)k
\end{matrix}\right]^\ast\\
&\begin{matrix}
=(q_wp_w &-q_xp_x&-q_yp_y&-q_zp_z)\\
+(-q_xp_w&-q_wp_x&+q_zp_y&-q_yp_z)i\\
+(-q_yp_w&-q_zp_x&-q_wp_y&+q_xp_z)j\\
+(-q_zp_w&+q_yp_x&-q_xp_y&-q_wp_z)k
\end{matrix}\\\\
&\tilde{p}^\ast\tilde{q}^\ast=(p_w-p_xi-p_yj-p_zk)(q_w-q_xi-q_yj-q_zk)\\
&\begin{matrix}
=(p_wq_w &-p_xq_x&-p_yq_y&-p_zq_z)\\
+(-p_xq_w&-p_wq_x&-p_zq_y&+p_yq_z)i\\
+(-p_yq_w&+p_zq_x&-p_wq_y&-p_xq_z)j\\
+(-p_zq_w&-p_yq_x&+p_xq_y&-p_wq_z)k
\end{matrix}\\\\
&\therefore (\tilde{q}\tilde{p})^\ast=\tilde{p}^\ast\tilde{q}^\ast\\
&\tilde{q}^\ast\tilde{p}^\ast=(\tilde{p}\tilde{q})^\ast
\end{matrix}\end{align}`$  
>>
>> - 文字の右上に$`\ast`$(アスタリスク)を付けることで<ruby>共役<rt>きょうやく</rt></ruby>クォータニオンを表す
>> - $`\tilde{q}`$の虚部の符号を反転したものを$`\tilde{q}`$の共役クォータニオンという
>> - クォータニオン積の共役クォータニオン$`(\tilde{q}\tilde{p})^\ast`$と共役クォータニオン同士のクォータニオン積$`\tilde{q}^\ast\tilde{p}^\ast`$は互いの順序を入れ替えたものと等しい
>>
> ## ノルム
>> $`\begin{align}&\|\tilde{q}\|=\sqrt{q_w^2+q_x^2+q_y^2+q_z^2}\end{align}`$  
>>
>> $`\tilde{q}\tilde{q}^\ast`$の成分を書き出して、ノルムの2乗になることを確認  
>> $`\begin{align}\begin{matrix}
&\tilde{q}\tilde{q}^\ast=(q_w+q_xi+q_yj+q_zk)(q_w-q_xi-q_yj-q_zk)\\
&\begin{matrix}
=(q_wq_w&+q_xq_x&+q_yq_y&+q_zq_z)\\
+(q_xq_w&-q_wq_x&+q_zq_y&-q_yq_z)i\\
+(q_yq_w&-q_zq_x&-q_wq_y&+q_xq_z)j\\
+(q_zq_w&+q_yq_x&-q_xq_y&-q_wq_z)k
\end{matrix}\\
&=q_w^2+q_x^2+q_y^2+q_z^2\\\\
&\therefore \tilde{q}\tilde{q}^\ast=\tilde{q}^\ast\tilde{q}=\|\tilde{q}\|^2
\end{matrix}\end{align}`$  
>>
>> ノルム同士の積とクォータニオン積のノルム  
>> $`\begin{align}\|\tilde{q}\|\|\tilde{p}\|=\|\tilde{q}\tilde{p}\|\end{align}`$  
>>
>> - 文字を$`\|`$(<ruby>双柱<rt>そうちゅう</rt></ruby>)で囲むことでノルムを表す
>> - $`\tilde{q}`$の大きさを$`\tilde{q}`$のノルムという
>> - 自身の共役クォータニオンとのクォータニオン積はノルムの2乗となる
>> - ノルム同士の積$`\|\tilde{q}\|\|\tilde{p}\|`$とクォータニオン積のノルム$`\|\tilde{q}\tilde{p}\|`$は等しい
>>
> ## 単位クォータニオン
>> - ノルムが1のクォータニオンを単位クォータニオンという
>>
> ## 正規化
>> $`\begin{align}\frac{\tilde{q}}{\|\tilde{q}\|}\end{align}`$  
>>
>> - ノルムで割ることで単位クォータニオンを作ることができる、この操作のことを正規化という
>>
> ## 逆クォータニオン
>> $`\begin{align}\tilde{q}^{-1}=\frac{1}{\tilde{q}}=\frac{\tilde{q}^\ast}{\tilde{q}\tilde{q}^\ast}=\frac{\tilde{q}^\ast}{\|\tilde{q}\|^2}\end{align}`$  
>>
>> - $`\tilde{q}`$の逆数を$`\tilde{q}`$の逆クォータニオンという
>> - 分母分子に共役クォータニオンを掛けることで分母がノルムの2乗となり有理化できる
>> - $`\tilde{q}`$が単位クォータニオンの場合は$`\tilde{q}`$の共役クォータニオンと同じとなる
>>
# クォータニオンとベクトル
>
> ## クォータニオン積とベクトルの対応
> ## ベクトルを回転させる
